---
import ExternalLink from "@components/ExternalLink.astro"
import Link from "@components/Link.astro"
import { websiteUrl } from "@shared/metadata"
import type { Post } from "@shared/posts"

type Props = {
    post: Post["data"]
}

const buildTwitterUrl = (post: Post["data"]) => {
    const url = websiteUrl(post.url)
    const text = `${post.title} by @MatteiniCosimo ${url}`
    return `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`
}

const buildMastodonUrl = (post: Post["data"]) => {
    const url = websiteUrl(post.url)
    const text = `${post.title} by @cosimomatteini ${url}`
    // DOCS: Cross-instance link to share on mastodon https://github.com/kytta/share2fedi
    return `https://toot.kytta.dev?text=${encodeURIComponent(text)}`
}

const { post } = Astro.props
---

<div class="flex gap-2 items-center">
    &#8227; <span>comment on</span>
    <ExternalLink href={buildMastodonUrl(post)}> mastodon </ExternalLink>
    /
    <ExternalLink href={buildTwitterUrl(post)}> twitter </ExternalLink>
</div>
